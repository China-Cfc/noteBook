# 进程、线程

 - 计算机操作系统与Linux
  
    - [52图初探Linux通用知识](https://mp.weixin.qq.com/s/dP8AJbvGgvYIXDy3zeXCRg)
    - [图解 | 计算机文件系统](https://mp.weixin.qq.com/s/j2msue1Hjcwd9z1U2p0TDQ)
    - [浏览器的秘密藏在这31张图里](https://mp.weixin.qq.com/s/11MRrxmiyZybTUbjRDRubQ)
    - [大厂面试Linux就这5个问题](https://mp.weixin.qq.com/s/24vBHgtw5efC9V9yYqknNg)
    - [Linux 内核 vs Windows 内核](https://mp.weixin.qq.com/s/7iQ5jO_qfYbwKdM21qywYg)
    - [学习linux命令，看这篇2w多字的命令详解就够了](https://mp.weixin.qq.com/s/7bSwKiPmtJbs7FtRWZZqpA)
    - [Linux IO 模型](https://mp.weixin.qq.com/s/TbIPlBtkK_zCyt54cCX8dw)
    - [带宽、延时、吞吐率、PPS 这些都是啥？](https://mp.weixin.qq.com/s/eWHQ8co0jF_a26Xz8ZQLjg)
    - 
    - [20 张图揭开内存管理的迷雾](https://mp.weixin.qq.com/s/oexktPKDULqcZQeplrFunQ)
    - [看完这篇操作系统，和面试官扯皮就没问题了。](https://mp.weixin.qq.com/s/59xyIj1nIFp2TtkKFYnR-g)
    - [进程间通信](https://mp.weixin.qq.com/s/mblyh6XrLj1bCwL0Evs-Vg)
    - [进程之间究竟有哪些通信方式？](https://mp.weixin.qq.com/s/CGqy0j5WvarN6mTmYB8vSA)
    - [键盘敲入 A 字母时，操作系统期间发生了什么...](https://mp.weixin.qq.com/s/fKHOf_CzG8HYXHlg54V_rg)
    - [一口气搞懂「文件系统」，就靠这 25 张图了](https://mp.weixin.qq.com/s/UT2JrfpkA5OUC9fJJ_MirQ)
    - [「网络IO套路」当时就靠它追到女友](https://mp.weixin.qq.com/s/x-AZQO5uiuu5svIvScotzA)
    - [10 张图打开 CPU 缓存一致性的大门](https://mp.weixin.qq.com/s/hjywA21UrvZSzdgvAr6fQA)
    - [敖丙说了这么多次 I/O，可你知道其中的原理么？](https://mp.weixin.qq.com/s/TJghsMRqkzBIsoHjGiEwFw)
    - [迄今为止把同步/异步/阻塞/非阻塞/BIO/NIO/AIO讲的这么清楚的好文章（快快珍藏）](https://mp.weixin.qq.com/s/EVequWGVMWV5Ki2llFzdHg)
    - [原来 8 张图，就能学废 Reactor 和 Proactor](https://mp.weixin.qq.com/s/px6-YnPEUCEqYIp_YHhDzg)
    - [2.5w字 + 36 张图+一周时间：爆肝操作系统面试题](https://mp.weixin.qq.com/s/ws6bgcv6dKIIJDwYYliMAg)
    - [计算机时间到底是怎么来的？](https://mp.weixin.qq.com/s/uM1ZNT8UwfvhqoscK8FJiQ)
    - [IO 多路复用](https://mp.weixin.qq.com/s/CMWlDywI1zbgJSoeGTBmuw)

## 1.进程，线程

[进程和线程基础知识全家桶，30 张图一套带走](https://mp.weixin.qq.com/s/FaHKGRI69TqDj0AJtNiVoA)

<!--我们写好的一行行代码，为了让其工作起来，我们还得把它送进城（进程）里，那既然进了城里，那肯定不能胡作非为了。城里人有城里人的规矩，城中有个专门管辖你们的城管（操作系统），人家让你休息就休息，让你工作就工作，毕竟摊位（CPU）就一个，每个人都要占这个摊位来工作，城里要工作的人多着去了。所以城管为了公平起见，它使用一种策略（调度）方式，给每个人一个固定的工作时间（时间片），时间到了就会通知你去休息而换另外一个人上场工作。另外，在休息时候你也不能偷懒，要记住工作到哪了，不然下次到你工作了，你忘记工作到哪了，那还怎么继续？有的人，可能还进入了县城（线程）工作，这里相对轻松一些，在休息的时候，要记住的东西相对较少，而且还能共享城里的资源-->

### 1.1 什么是进程?

编写的代码是存在硬盘里的静态文件,编译后生成可执行文件,运行这个文件,装载到内存中,然后CPU执行文件中的每一条指令,这个运行中的程序就是**进程**

**进程**

CPU在执行某个进程文件时假如读取硬盘数据，读取硬盘数据速度很慢，CPU不会一直等待数据的返回，而是去执行另外的进程，数据返回时会收到一个***中断***，CPU再回来执行这个进程

多个程序，交替执行的思想，是CPU管理多个进程的初步想法。

CPU在一瞬间内只执行一个进程，在几秒内可以执行多个进程，所以他不是并行运行，被称为并发

**进程与程序的关系的类比**

CPU从一个进程到另一个进程的切换时，必须记录当前进程的状态信息，以备下一次切换回来时可以恢复执行。

所以，进程就有  **运行-暂停-运行** 活动规律。

---

### 1.2 进程的状态

- 进程活动期间至少有三种状态：运行状态、阻塞状态、就绪状态

![图片](../../tuxiang/640)

上图各状态的的意义：

- 运行状态(`running`)：此刻进程占用cpu
- 就绪状态(`Ready`)：可运行，但因其他进程占用cpu运行而暂停停止
- 阻塞状态(`Blocked`)：该进程在等待某个事件的发生而暂停停止运行，这时，即时给他cpu控制权，他也无法运行



当然，进程另外两个基础状态：

- 创建状态(`new`):进程正在被创建
- 结束状态(`Exit`):进程正在从系统中消失



于是，一个完整的进程状态的变迁就如下图：

![641](../../tuxiang/641.png)



再来详细说明一下进程的状态变迁：

- *NULL -> 创建状态*：一个新进程被创建时的第一个状态；
- *创建状态 -> 就绪状态*：当进程被创建完成并初始化后，一切就绪准备运行时，变为就绪状态，这个过程是很快的；
- *就绪态 -> 运行状态*：处于就绪状态的进程被操作系统的进程调度器选中后，就分配给 CPU 正式运行该进程；
- *运行状态 -> 结束状态*：当进程已经运行完成或出错时，会被操作系统作结束状态处理；
- *运行状态 -> 就绪状态*：处于运行状态的进程在运行过程中，由于分配给它的运行时间片用完，操作系统会把该进程变为就绪态，接着从就绪态选中另外一个进程运行；
- *运行状态 -> 阻塞状态*：当进程请求某个事件且必须等待时，例如请求 I/O 事件；
- *阻塞状态 -> 就绪状态*：当进程要等待的事件完成时，它从阻塞状态变到就绪状态；



另外，还有一个状态叫**挂起状态**，它表示进程没有占有内存空间。这跟阻塞状态是不一样，阻塞状态是等待某个事件的返回。

由于虚拟内存管理原因，进程的所使用的空间可能并没有映射到物理内存，而是在硬盘上，这时进程就会出现挂起状态。

<img src="../../tuxiang/642.png" alt="642" style="zoom:50%;" />





挂起状态可以分为两种：

- 阻塞挂起状态：进程在外存（硬盘）并等待某个事件的出现；
- 就绪挂起状态：进程在外存（硬盘），但只要进入内存，即刻立刻运行；

这两种挂起状态加上前面的五种状态，就变成了七种状态变迁（留给我的颜色不多了），见如下图：

<img src="../../tuxiang/643.png" alt="643" style="zoom:50%;" />

---

### 1.3 进程的控制结构

在操作系统中是用**进程控制块**（**`process control block，PCB`**）数据结构来描述进程的。

`PCB`是进程存在的唯一标识,意味着一个进程只要存在,就有一个`PCB`,如果进程消失,`PCB`也消失.

#### **1.3.1 PCB包含哪些信息?**

**进程描述信息:**

- 进程标识符:标记每个进程,每个进程都有自己的唯一标识符;
- 用户标识符:进程归属的用户,主要是为了共享和保护服务;

**进程控制和管理信息:**

- 进程当前的状态:如 new,ready,blocked,running,waiting,exit等;
- 进程优先级:进程抢占CPU的优先级;

**资源分配清单:**

- 有关内存地址空间和虚拟地址空间信息,所带开的文件列表和使用的I/O设备信息

**CPU相关信息**

- CPU中各个寄存器的值,当进程被切换时，CPU 的状态信息都会被保存在相应的 PCB 中，以便进程重新执行时，能从断点处继续执行。





---

---

## 进程线程的通讯方式





## 进程调度算法





## 进程线程状态





## 死锁



## 内存管理





## linux





## 资源推荐--视频--[《清华操作系统原理》](https://www.bilibili.com/video/BV1uW411f72n)

